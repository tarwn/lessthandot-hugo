---
title: SQL Azure Log Space Errors 40552
author: Ted Krueger (onpnt)
type: post
date: 2013-04-15T17:02:00+00:00
excerpt: |
  If you are dealing with SQL Azure and a large data volume, you’re bound to run into this error.
  Msg 40552, Level 20, State 1, Line 1   The session has been terminated because of excessive transaction log space usage. Try modifying fewer rows in a singl&hellip;
url: /index.php/webdev/business-intelligence/sql-azure-log-space-errors/
views:
  - 24596
rp4wp_auto_linked:
  - 1
categories:
  - Business Intelligence

---
If you are dealing with SQL Azure and a large data volume, you’re bound to run into this error.

<span class="MT_red">Msg 40552, Level 20, State 1, Line 1 <br /> The session has been terminated because of excessive transaction log space usage. Try modifying fewer rows in a single transaction</span>

This error is more of a pain than anything and you can work around it. 

 <img style="float: left;" src="data:image/png;base64,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" alt="" />The structural architecture that SQL Azure uses and all around resource allocations, doesn’t allow us to go in there and simply size a transaction log like we with SQL Server on metal.  At least, I haven’t found one.  With that, we run into a mess of headaches when we have anything over a few hundred thousand rows in one table.  Here is what you can do, to get beyond this error.

**Changing Data and Log Usage Errors**

Changing data means just that – updating, inserting or deleting large amounts of data.  If you run into this error while loading data, try to perform the [age old method of batch processing data][1].  Now this goes against almost every fiber of a performance mindset given the advancements in data loading and transformation.  However, it’s a life we have to work around while in SQL Azure.  With SSIS, you can create multiple threads and work on each thread while only sending so much at once to SQL Azure.  SSIS is fully capable of batch processing data also.

**Creating, Rebuilding a Big Index and Log Usage Errors**

Indexing is what got this article to be published.  If you have a few hundred million rows in a table, create a nonclustered index on that table, you will undoubtedly result in the log space usage error.  For a moment, this raised great concern.  Truly, the data is no good in SQL Azure if you cannot read it in under 30 minutes, preferably seconds.  So you need indexing to support the queries that are going to be used to read the data effectively.  Luckily, SQL Azure does support [ONLINE operations in indexing][2].

In this case, the ONLINE operation with a CREATE INDEX statement provides the functionality of the index to be built by taking advantage of the build main phase.  This performs the primary needs of reading the table and then inserting by means of bulk loading operations, into the new index.

To create the index with ONLINE, you simply specify the ON value in the options.

<pre>CREATE NONCLUSTERED INDEX [IDX_SalesOrderID_COVER_ASC] ON [dbo].[IndexPageCount]
(
	[SalesOrderID] ASC
)
INCLUDE ([DueDate],
	[ShipDate],
	[SubTotal]) WITH ONLINE = ON)  
GO</pre>

This “should” allow the index creation to complete.  It will take longer for the creation but, the importance of having indexing is without a doubt, not something you can give up.  Unless the data is simply a DR strategy or some sort of backup.

 [1]: https://www.google.com/search?safe=off&biw=1920&bih=962&q=loading+data+in+batch+t-sql+prevent+log+growth
 [2]: http://msdn.microsoft.com/en-us/library/ms191261.aspx